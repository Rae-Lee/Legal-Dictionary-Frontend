(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-001d90d2"],{1584:function(t,e,s){},"16af":function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"post-preview dashboard"},[e("div",[e("span",{staticClass:"post-title"},[e("router-link",{staticClass:"post",attrs:{to:"/"}},[e("i",{staticClass:"fa-solid fa-angle-left angle post"})]),t._v(t._s(t.keyword.name)+" "),e("a",{attrs:{disabled:t.isProcessing},on:{click:function(e){return t.addFavorite(t.keyword.id)}}},[e("i",{directives:[{name:"show",rawName:"v-show",value:!t.isFavorite,expression:"!isFavorite"}],staticClass:"fa-regular fa-heart heart"})]),e("a",{attrs:{disabled:t.isProcessing},on:{click:function(e){return t.deleteFavorite(t.keyword.id)}}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isFavorite,expression:"isFavorite"}],staticClass:"fa-solid fa-heart heart"})])],1),e("hr",{staticClass:"horizon"}),e("div",{staticClass:"filters mt-5",attrs:{id:"filters"}},[e("router-link",{staticClass:"px-3 switch",attrs:{to:{name:"keywords articles",params:{id:t.keyword.id}}}},[t._v("相關法條")]),e("router-link",{staticClass:"px-3 switch",attrs:{to:{name:"keywords references",params:{id:t.keyword.id}}}},[t._v("相關裁判")]),e("router-link",{staticClass:"px-3 switch",attrs:{to:{name:"keywords notes",params:{id:t.keyword.id}}}},[t._v("我的筆記")])],1)])])},i=[],r={props:{keyword:{type:Object,required:!0},isFavorite:{type:Boolean,default:!1},isProcessing:{type:Boolean,default:!0}},methods:{async addFavorite(t){this.$emit("addFavorite",t)},async deleteFavorite(t){this.$emit("deleteFavorite",t)}}},o=r,n=(s("c1a2"),s("2877")),d=Object(n["a"])(o,a,i,!1,null,null,null);e["a"]=d.exports},"44e9":function(t,e,s){"use strict";s("842d")},"52f5":function(t,e,s){},"842d":function(t,e,s){},"8e06":function(t,e,s){"use strict";s("52f5")},"9ce8":function(t,e,s){"use strict";var a=s("2fa3");e["a"]={getTopKeyword(){return a["a"].get("/keywords/top")},getKeywordArticles({page:t,id:e}){const s=new URLSearchParams({page:t});return a["a"].get(`/keywords/${e}/articles?${s.toString()}`)},getKeywordReferences({page:t,id:e}){const s=new URLSearchParams({page:t});return a["a"].get(`/keywords/${e}/references?${s.toString()}`)},getKeywordNotes({page:t,id:e}){const s=new URLSearchParams({page:t});return a["a"].get(`/keywords/${e}/notes?${s.toString()}`)},addKeyword({name:t}){return a["a"].post("/keywords",{name:t})},getKeyword({id:t}){return a["a"].get("/keywords/"+t)},getFavorite({id:t}){return a["a"].get(`keywords/${t}/likes`)},addKeywordNotes({id:t,content:e}){return a["a"].post(`/keywords/${t}/notes`,{content:e})}}},a151:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[e("div",[t.isProcessing?t._e():e("keywordTitle",{attrs:{keyword:t.keyword,"is-favorite":t.favorite,"is-processing":t.isProcessing},on:{addFavorite:t.addLike,deleteFavorite:t.deleteLike}}),t.errMessage?e("div",[t.errMessage?e("h1",{staticClass:"text-center err"},[t._v(t._s(t.errMessage))]):t._e()]):t._e(),t.errMessage||t.isLoading?t._e():e("noteCard",{attrs:{"initial-notes":t.notes}})],1),e("pagination",{attrs:{totalPage:t.totalPage,currentPage:t.currentPage}})],1)},i=[],r=s("16af"),o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notes"},[e("div",{staticClass:"card frame my-3"},[e("div",{staticClass:"d-flex card-body justify-content-between"},[e("div",{staticClass:"content d-flex"},[t._m(0),e("div",{staticClass:"author-content pl-4 ps-4"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newNote,expression:"newNote"}],staticClass:"mb-3 card-text new-note",attrs:{rows:"5",type:"text",placeholder:"寫下筆記",required:"",autofocus:""},domProps:{value:t.newNote},on:{input:function(e){e.target.composing||(t.newNote=e.target.value)}}})])]),e("div",{staticClass:"close"},[e("button",{staticClass:"save-button btn btn-outline-secondary",attrs:{type:"button","aria-label":"add",disabled:t.isLoading},on:{click:function(e){return t.addNote(t.notes[0].elementId)}}},[t._v(t._s(t.isLoading?"處理中...":"新增"))])])])]),t._l(t.notes,(function(s){return e("div",{key:s.id,staticClass:"card frame my-3"},[e("div",{staticClass:"d-flex card-body justify-content-between"},[e("div",{staticClass:"content d-flex"},[t._m(1,!0),e("div",{staticClass:"author-content pl-4 ps-4"},[e("h5",{staticClass:"mb-3 field card-subtitle"},[t._v(t._s(t._f("fromNow")(s.createdAt)))]),e("h4",{directives:[{name:"show",rawName:"v-show",value:t.currentNote.id!==s.id,expression:"currentNote.id !== note.id"}],staticClass:"mb-3 card-text"},[t._v(t._s(s.content)+" ")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currentNote.content,expression:"currentNote.content"},{name:"show",rawName:"v-show",value:t.currentNote.id===s.id,expression:"currentNote.id === note.id"}],staticClass:"mb-3 card-text new-note",attrs:{rows:"5",type:"text",required:"",autofocus:"",placeholder:"寫下筆記"},domProps:{value:t.currentNote.content},on:{input:function(e){e.target.composing||t.$set(t.currentNote,"content",e.target.value)}}})])]),e("div",{staticClass:"close"},[e("button",{staticClass:"btn-close",attrs:{type:"button","aria-label":"Close",disabled:t.isDeleting},on:{click:function(e){return t.deleteNote(s)}}})])]),e("div",{staticClass:"edit"},[e("button",{directives:[{name:"show",rawName:"v-show",value:t.currentNote.id===s.id,expression:"currentNote.id === note.id"}],staticClass:"edit-button btn btn-outline-secondary mx-2",attrs:{type:"button","aria-label":"save",disabled:t.isEditing},on:{click:function(e){return t.saveNote(s)}}},[t._v("儲存")]),e("button",{directives:[{name:"show",rawName:"v-show",value:t.currentNote.id!==s.id,expression:"currentNote.id !== note.id"}],staticClass:"edit-button btn btn-outline-secondary",attrs:{type:"button","aria-label":"edit"},on:{click:function(e){return t.editNote(s)}}},[t._v("編輯")])])])}))],2)},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"author-img"},[e("i",{staticClass:"fa-regular fa-circle-user photo"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"author-img"},[e("i",{staticClass:"fa-regular fa-circle-user photo"})])}],d=s("c1df"),c=s.n(d),u=s("9ce8"),l=s("29cf"),h=s("2fa3"),g={props:{initialNotes:{type:Array,required:!0}},data(){return{notes:this.initialNotes,newNote:"",currentNote:{},isLoading:!1,isEditing:!1,isDeleting:!1}},methods:{async deleteNote(t){try{const e=t.id;this.isDeleting=!0;const s=await l["a"].deleteNotes({id:e}),{data:a}=s;if(200!==a.status)return Object(h["b"])(a,this.$router),void(this.isDeleting=!1);this.notes=this.notes.filter(t=>t.id!==e),this.isDeleting=!1}catch(e){this.isDeleting=!1,Object(h["b"])({status:500})}},async addNote(t){try{const e=this.newNote;e||Object(h["b"])({status:400,message:["筆記內容不得空白!"]}),this.isLoading=!0;const s=await u["a"].addKeywordNotes({id:t,content:e}),{data:a}=s;if(200!==a.status)return Object(h["b"])(a,this.$router),void(this.isLoading=!1);const i=[a.data,...this.notes];this.notes=i,console.log(this.notes),this.isLoading=!1,this.newNote=""}catch(e){this.isLoading=!1,Object(h["b"])({status:500})}},editNote(t){this.currentNote={...t}},async saveNote(t){try{const{id:t,content:e}=this.currentNote;if(!e)return void Object(h["b"])({status:400,message:["筆記內容不得空白!"]});this.isEditing=!0;const s=await l["a"].editNotes({id:t,content:e}),{data:a}=s;if(200!==a.status)return Object(h["b"])(a,this.$router),void(this.isEditing=!1);this.notes=this.notes.map(s=>s.id===t?{...s,content:e}:s),this.isEditing=!1,this.currentNote={}}catch(e){this.isEditing=!1,Object(h["b"])({status:500})}}},filters:{fromNow(t){return t?c()(t).fromNow():"-"}}},v=g,w=(s("44e9"),s("2877")),f=Object(w["a"])(v,o,n,!1,null,null,null),p=f.exports,b=s("6407"),y=s("4cce"),m={components:{noteCard:p,pagination:b["a"],keywordTitle:r["a"]},data(){return{notes:[],user:{},currentPage:1,totalPage:1,keyword:{id:-1,name:""},favorite:!1,errMessage:"",isProcessing:!0,isLoading:!0}},beforeRouteUpdate(t,e,s){const{id:a}=t.params,{page:i=""}=t.query;this.fetchData({page:i,id:a}),s()},created(){const{page:t=""}=this.$route.query,{id:e}=this.$route.params;this.fetchData({page:t,id:e})},methods:{async fetchData({page:t,id:e}){try{const s=await u["a"].getKeywordNotes({page:t,id:e}),a=await u["a"].getKeyword({id:e}),i=await u["a"].getFavorite({id:e});200!==s.data.status?(404===s.data.status&&(this.errMessage=s.data.message),Object(h["b"])(s.data,this.$router)):(this.notes=s.data.data.notes,this.currentPage=Number(s.data.pagination.currentPage),this.totalPage=Number(s.data.pagination.totalPage)),200!==a.data.status?(404===a.data.status&&(this.errMessage=a.data.message),Object(h["b"])(a.data,this.$router)):this.keyword={...this.keyword,...a.data.data},200!==i.data.status?Object(h["b"])(i.data,this.$router):this.favorite=i.data.data.isFavorite,this.isProcessing=!1,this.isLoading=!1}catch(s){Object(h["b"])({status:500})}},async addLike(t){try{this.isProcessing=!0;const e=await y["a"].addFavorite({id:t}),{data:s}=e;if(200!==s.status)return Object(h["b"])(s,this.$router),void(this.isProcessing=!1);this.favorite=!0,this.isProcessing=!1}catch(e){Object(h["b"])({status:500})}},async deleteLike(t){try{this.isProcessing=!0;const e=await y["a"].deleteFavorite({id:t}),{data:s}=e;return 200!==s.status?(Object(h["b"])(s,this.$router),void(this.isProcessing=!1)):(this.favorite=!1,void(this.isProcessing=!1))}catch(e){Object(h["b"])({status:500})}}}},N=m,k=(s("8e06"),Object(w["a"])(N,a,i,!1,null,null,null));e["default"]=k.exports},c1a2:function(t,e,s){"use strict";s("1584")}}]);
//# sourceMappingURL=chunk-001d90d2.5cdfac00.js.map